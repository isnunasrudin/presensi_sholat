import{r as c,I as U,o as H,c as p,e as t,y as e,t as l,q as i,j as f,d,R as G,s as b,v as T,p as J,D as Q}from"./vue-Bki0M6Jk.js";import{u as W,a as y}from"./app-BtTGz4Tf.js";import{x as X}from"./primevue-BWgMG8pc.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"dashboard"},tt={class:"page-title"},st={class:"welcome-card"},at={class:"welcome-content"},et={class:"welcome-text"},lt={class:"welcome-date"},nt={key:0,class:"user-dashboard"},ot={class:"stats-grid"},it={class:"stat-content"},rt={class:"stat-info"},dt={class:"stat-content"},ut={class:"stat-info"},pt={class:"stat-content"},ct={class:"stat-info"},vt={class:"stat-content"},ht={class:"stat-info"},yt={class:"today-status"},mt={class:"today-grid"},gt={class:"today-item"},kt={key:0,class:"prayer-status"},_t={key:0,class:"prayer-notes"},ft={key:1,class:"prayer-empty"},bt={class:"today-item"},St={key:0,class:"prayer-status"},Dt={key:0,class:"prayer-notes"},wt={key:1,class:"prayer-empty"},Ct={class:"quick-actions"},Tt={class:"action-buttons"},$t={key:1,class:"admin-dashboard"},qt={class:"admin-stats"},Bt={class:"stats-row"},It={class:"stat-content"},Vt={class:"stat-info"},Rt={class:"stat-content"},At={class:"stat-info"},Nt={class:"stats-grid !mb-5"},Ot={class:"stat-content"},Pt={class:"stat-info"},Ut={class:"stat-content"},jt={class:"stat-info"},Et={class:"stat-content"},Ft={class:"stat-info"},zt={class:"stat-content"},Mt={class:"stat-info"},Kt={class:"admin-actions"},Lt={class:"action-grid"},xt={class:"field"},Ht={key:0,class:"p-error"},Gt={class:"field"},Jt={key:0,class:"p-error"},Qt={class:"field"},Wt={class:"dialog-actions"},Xt={__name:"Dashboard",setup(Yt){const S=W(),q=X(),k=c({total:0,sholat:0,tidak_sholat:0,halangan:0,percentage_sholat:0}),h=c({total_users:0,total_rombels:0,sholat:0,tidak_sholat:0,halangan:0,percentage_sholat:0}),j=c([]),m=c(null),g=c(null),B=c(""),_=c(!1),$=c(!1),v=c({}),u=c({prayer_type:null,status:null,notes:""}),E=[{label:"Sholat Dhuha",value:"dhuha"},{label:"Sholat Dhuhur",value:"dhuhur"}],F=[{label:"Sholat",value:"sholat"},{label:"Tidak Sholat",value:"tidak_sholat"},{label:"Berhalangan",value:"halangan"}],D=U(()=>!S.isAdmin),w=U(()=>S.isAdmin),I=()=>{B.value=new Date().toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},V=async()=>{try{const a={start_date:new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0]},s=await y.get("/prayer-records-statistics",{params:a});k.value=s.data}catch(a){console.error("Error fetching statistics:",a)}},z=async()=>{try{const a=await y.get("/prayer-records-statistics",{params:{start_date:new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0]}}),s=await y.get("/users"),n=(s.data.data||s.data).length,r=await y.get("/rombongan-belajar"),C=(r.data.data||r.data).length;h.value={...a.data,total_users:n,total_rombels:C}}catch(a){console.error("Error fetching admin stats:",a)}},R=async()=>{if(!w.value)try{const a=new Date().toISOString().split("T")[0],n=(await y.get("/prayer-records",{params:{start_date:a,end_date:a,per_page:10}})).data.data||[];m.value=n.find(r=>r.prayer_type==="dhuha"),g.value=n.find(r=>r.prayer_type==="dhuhur")}catch(a){console.error("Error fetching today status:",a)}},A=async()=>{try{const a=await y.get("/prayer-records",{params:{per_page:5}});j.value=a.data.data||[]}catch(a){console.error("Error fetching recent records:",a)}},N=a=>{u.value={prayer_type:a,status:null,notes:""},v.value={},_.value=!0},M=async()=>{v.value={},$.value=!0;try{const a={prayer_type:u.value.prayer_type,date:new Date().toISOString().split("T")[0],status:u.value.status,notes:u.value.notes};w.value&&(a.user_id=S.user.id),await y.post("/prayer-records",a),q.add({severity:"success",summary:"Berhasil",detail:"Catatan sholat berhasil disimpan",life:3e3}),_.value=!1,R(),V(),A()}catch(a){a.response?.data?.errors?v.value=a.response.data.errors:q.add({severity:"error",summary:"Error",detail:a.response?.data?.message||"Gagal menyimpan catatan",life:3e3})}finally{$.value=!1}},K=a=>a.toISOString().split("T")[0],O=a=>({sholat:"prayer-badge success",tidak_sholat:"prayer-badge danger",halangan:"prayer-badge warning"})[a]||"prayer-badge empty",P=a=>({sholat:"OK",tidak_sholat:"-",halangan:"Halangan"})[a]||"-";return H(()=>{I(),w.value?z():(V(),R()),A(),setInterval(I,6e4)}),(a,s)=>{const n=f("Card"),r=f("Button"),C=f("Dropdown"),L=f("Textarea"),x=f("Dialog");return d(),p("div",Z,[t("h1",tt,l(D.value?"Dashboard Sholat":"Dashboard Manajemen Sholat"),1),t("div",st,[e(n,null,{content:i(()=>[t("div",at,[t("div",et,[t("h2",null,l(D.value?`Selamat Datang, ${G(S).user?.name}! ðŸ‘‹`:"Dashboard Manajemen Sholat ðŸ“Š"),1),t("p",null,l(D.value?"Lacak kehadiran sholat Dhuhur dan Dhuha harian Anda":"Pantau statistik kehadiran sholat seluruh siswa"),1)]),t("div",lt,[s[16]||(s[16]=t("i",{class:"pi pi-calendar"},null,-1)),t("span",null,l(B.value),1)])])]),_:1})]),D.value?(d(),p("div",nt,[t("div",ot,[e(n,{class:"stat-card"},{content:i(()=>[t("div",it,[s[18]||(s[18]=t("i",{class:"pi pi-check-circle stat-icon success"},null,-1)),t("div",rt,[t("h3",null,l(k.value.sholat),1),s[17]||(s[17]=t("p",null,"Sholat Selesai",-1))])])]),_:1}),e(n,{class:"stat-card"},{content:i(()=>[t("div",dt,[s[20]||(s[20]=t("i",{class:"pi pi-times-circle stat-icon danger"},null,-1)),t("div",ut,[t("h3",null,l(k.value.tidak_sholat),1),s[19]||(s[19]=t("p",null,"Sholat Terlewat",-1))])])]),_:1}),e(n,{class:"stat-card"},{content:i(()=>[t("div",pt,[s[22]||(s[22]=t("i",{class:"pi pi-info-circle stat-icon warning"},null,-1)),t("div",ct,[t("h3",null,l(k.value.halangan),1),s[21]||(s[21]=t("p",null,"Berhalangan",-1))])])]),_:1}),e(n,{class:"stat-card"},{content:i(()=>[t("div",vt,[s[24]||(s[24]=t("i",{class:"pi pi-chart-line stat-icon info"},null,-1)),t("div",ht,[t("h3",null,l(k.value.percentage_sholat)+"%",1),s[23]||(s[23]=t("p",null,"Tingkat Kehadiran",-1))])])]),_:1})]),t("div",yt,[e(n,null,{header:i(()=>[...s[25]||(s[25]=[t("h3",{class:"card-title"},"Status Sholat Hari Ini",-1)])]),content:i(()=>[t("div",mt,[t("div",gt,[s[27]||(s[27]=t("div",{class:"prayer-header"},[t("i",{class:"pi pi-sun prayer-icon dhuha"}),t("h4",null,"Sholat Dhuha")],-1)),m.value?(d(),p("div",kt,[t("span",{class:T(O(m.value.status))},l(P(m.value.status)),3),m.value.notes?(d(),p("small",_t,l(m.value.notes),1)):b("",!0)])):(d(),p("div",ft,[s[26]||(s[26]=t("span",{class:"empty-badge"},"Belum Dicatat",-1)),e(r,{label:"Catat Sekarang",icon:"pi pi-plus",size:"small",onClick:s[0]||(s[0]=o=>N("dhuha")),class:"mt-2"})]))]),t("div",bt,[s[29]||(s[29]=t("div",{class:"prayer-header"},[t("i",{class:"pi pi-sun prayer-icon dhuhur"}),t("h4",null,"Sholat Dhuhur")],-1)),g.value?(d(),p("div",St,[t("span",{class:T(O(g.value.status))},l(P(g.value.status)),3),g.value.notes?(d(),p("small",Dt,l(g.value.notes),1)):b("",!0)])):(d(),p("div",wt,[s[28]||(s[28]=t("span",{class:"empty-badge"},"Belum Dicatat",-1)),e(r,{label:"Catat Sekarang",icon:"pi pi-plus",size:"small",onClick:s[1]||(s[1]=o=>N("dhuhur")),class:"mt-2"})]))])])]),_:1})]),t("div",Ct,[e(n,null,{header:i(()=>[...s[30]||(s[30]=[t("h3",{class:"card-title"},"Aksi Cepat",-1)])]),content:i(()=>[t("div",Tt,[e(r,{label:"Catat Sholat Hari Ini",icon:"pi pi-plus",onClick:s[2]||(s[2]=o=>a.$router.push("/prayer-records")),size:"large"}),e(r,{label:"Riwayat Sholat",icon:"pi pi-list",onClick:s[3]||(s[3]=o=>a.$router.push("/prayer-records")),severity:"secondary",size:"large"}),w.value?b("",!0):(d(),J(r,{key:0,label:"Scan NFC",icon:"pi pi-mobile",onClick:s[4]||(s[4]=o=>a.$router.push("/nfc-scanner")),severity:"info",size:"large"}))])]),_:1})])])):(d(),p("div",$t,[t("div",qt,[t("div",Bt,[e(n,{class:"stat-card wide"},{content:i(()=>[t("div",It,[s[32]||(s[32]=t("i",{class:"pi pi-users stat-icon info"},null,-1)),t("div",Vt,[t("h3",null,l(h.value.total_users),1),s[31]||(s[31]=t("p",null,"Total Pengguna",-1))])])]),_:1}),e(n,{class:"stat-card wide"},{content:i(()=>[t("div",Rt,[s[34]||(s[34]=t("i",{class:"pi pi-building stat-icon info"},null,-1)),t("div",At,[t("h3",null,l(h.value.total_rombels),1),s[33]||(s[33]=t("p",null,"Total Rombel",-1))])])]),_:1})]),t("div",Nt,[e(n,{class:"stat-card"},{content:i(()=>[t("div",Ot,[s[36]||(s[36]=t("i",{class:"pi pi-check-circle stat-icon success"},null,-1)),t("div",Pt,[t("h3",null,l(h.value.sholat),1),s[35]||(s[35]=t("p",null,"Sholat Selesai",-1))])])]),_:1}),e(n,{class:"stat-card"},{content:i(()=>[t("div",Ut,[s[38]||(s[38]=t("i",{class:"pi pi-times-circle stat-icon danger"},null,-1)),t("div",jt,[t("h3",null,l(h.value.tidak_sholat),1),s[37]||(s[37]=t("p",null,"Sholat Terlewat",-1))])])]),_:1}),e(n,{class:"stat-card"},{content:i(()=>[t("div",Et,[s[40]||(s[40]=t("i",{class:"pi pi-info-circle stat-icon warning"},null,-1)),t("div",Ft,[t("h3",null,l(h.value.halangan),1),s[39]||(s[39]=t("p",null,"Berhalangan",-1))])])]),_:1}),e(n,{class:"stat-card"},{content:i(()=>[t("div",zt,[s[42]||(s[42]=t("i",{class:"pi pi-chart-line stat-icon info"},null,-1)),t("div",Mt,[t("h3",null,l(h.value.percentage_sholat)+"%",1),s[41]||(s[41]=t("p",null,"Tingkat Kehadiran",-1))])])]),_:1})])]),t("div",Kt,[e(n,null,{header:i(()=>[...s[43]||(s[43]=[t("h3",{class:"card-title"},"Manajemen Sholat",-1)])]),content:i(()=>[t("div",Lt,[t("div",{class:"action-item",onClick:s[5]||(s[5]=o=>a.$router.push("/prayer-records"))},[...s[44]||(s[44]=[t("i",{class:"pi pi-list action-icon"},null,-1),t("h4",null,"Catatan Sholat",-1),t("p",null,"Kelola catatan sholat harian",-1)])]),t("div",{class:"action-item",onClick:s[6]||(s[6]=o=>a.$router.push("/prayer-records?date="+K(new Date)))},[...s[45]||(s[45]=[t("i",{class:"pi pi-calendar-day action-icon"},null,-1),t("h4",null,"Data Hari Ini",-1),t("p",null,"Lihat catatan sholat hari ini",-1)])]),t("div",{class:"action-item",onClick:s[7]||(s[7]=o=>a.$router.push("/nfc-scanner"))},[...s[46]||(s[46]=[t("i",{class:"pi pi-mobile action-icon"},null,-1),t("h4",null,"Scan NFC",-1),t("p",null,"Scan kehadiran dengan NFC",-1)])]),t("div",{class:"action-item",onClick:s[8]||(s[8]=o=>a.$router.push("/nfc-writer"))},[...s[47]||(s[47]=[t("i",{class:"pi pi-qrcode action-icon"},null,-1),t("h4",null,"Write NFC",-1),t("p",null,"Tulis kartu NFC baru",-1)])]),t("div",{class:"action-item",onClick:s[9]||(s[9]=o=>a.$router.push("/user-recap"))},[...s[48]||(s[48]=[t("i",{class:"pi pi-chart-bar action-icon"},null,-1),t("h4",null,"Rekap User",-1),t("p",null,"Statistik per pengguna",-1)])]),t("div",{class:"action-item",onClick:s[10]||(s[10]=o=>a.$router.push("/users"))},[...s[49]||(s[49]=[t("i",{class:"pi pi-users action-icon"},null,-1),t("h4",null,"Manajemen User",-1),t("p",null,"Kelola data pengguna",-1)])])])]),_:1})])])),e(x,{visible:_.value,"onUpdate:visible":s[15]||(s[15]=o=>_.value=o),header:"Catat Sholat Cepat",modal:!0,style:{width:"450px"}},{default:i(()=>[t("form",{onSubmit:Q(M,["prevent"]),class:"dialog-form"},[t("div",xt,[s[50]||(s[50]=t("label",{for:"quickPrayerType"},"Jenis Sholat *",-1)),e(C,{id:"quickPrayerType",modelValue:u.value.prayer_type,"onUpdate:modelValue":s[11]||(s[11]=o=>u.value.prayer_type=o),options:E,optionLabel:"label",optionValue:"value",placeholder:"Pilih jenis sholat",class:T({"p-invalid":v.value.prayer_type}),disabled:!!u.value.prayer_type},null,8,["modelValue","class","disabled"]),v.value.prayer_type?(d(),p("small",Ht,l(v.value.prayer_type),1)):b("",!0)]),t("div",Gt,[s[51]||(s[51]=t("label",{for:"quickStatus"},"Status *",-1)),e(C,{id:"quickStatus",modelValue:u.value.status,"onUpdate:modelValue":s[12]||(s[12]=o=>u.value.status=o),options:F,optionLabel:"label",optionValue:"value",placeholder:"Pilih status",class:T({"p-invalid":v.value.status})},null,8,["modelValue","class"]),v.value.status?(d(),p("small",Jt,l(v.value.status),1)):b("",!0)]),t("div",Qt,[s[52]||(s[52]=t("label",{for:"quickNotes"},"Catatan",-1)),e(L,{id:"quickNotes",modelValue:u.value.notes,"onUpdate:modelValue":s[13]||(s[13]=o=>u.value.notes=o),rows:"3",placeholder:"Tambahkan catatan..."},null,8,["modelValue"])]),t("div",Wt,[e(r,{label:"Batal",onClick:s[14]||(s[14]=o=>_.value=!1),severity:"secondary",text:""}),e(r,{type:"submit",label:"Simpan",loading:$.value},null,8,["loading"])])],32)]),_:1},8,["visible"])])}}},es=Y(Xt,[["__scopeId","data-v-9010fce8"]]);export{es as default};
