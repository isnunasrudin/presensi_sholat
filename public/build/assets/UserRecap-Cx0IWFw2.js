import{a as N,r as _,m as A,c as y,f as a,b as t,w as r,d as u,p as L,o as k,j as P,y as $,F as z,s as I,t as n,i as M,n as D}from"./app-BAyi6xf7.js";import{U as R}from"./UserMonthlyCalendar-VRKjr4jq.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"user-recap"},j={class:"filters"},J={class:"filter-group"},O={class:"filter-group"},Y={class:"filter-group"},q={class:"user-header-section"},G={class:"user-info-section"},K={class:"user-name"},Q={class:"user-email"},W={class:"stats-section"},X={class:"stat-card"},Z={class:"stat-content"},aa={class:"stat-number"},sa={class:"stat-card"},ea={class:"stat-content"},ta={class:"stat-number success-text"},la={class:"stat-card"},oa={class:"stat-content"},na={class:"stat-number danger-text"},ra={class:"stat-card"},da={class:"stat-content"},ia={class:"stat-number warning-text"},ua={class:"progress-section"},ca={class:"progress-header"},pa={class:"progress-percentage"},_a={class:"font-semibold"},va={class:"text-green-600 font-semibold"},ma={class:"text-red-600 font-semibold"},ga={class:"text-orange-600 font-semibold"},ha={class:"flex items-center gap-2"},fa={class:"font-semibold"},ba={__name:"UserRecap",setup(ya){const S=N(),g=_([]),v=_(!1),h=_(!1),f=_(null),d=_({prayer_type:null,start_date:null,end_date:null}),T=[{label:"All",value:null},{label:"Dhuhur",value:"dhuhur"},{label:"Dhuha",value:"dhuha"}],c=async()=>{v.value=!0;try{const l={...d.value};l.start_date&&(l.start_date=C(l.start_date)),l.end_date&&(l.end_date=C(l.end_date));const s=await L.get("/prayer-records-user-recap",{params:l});g.value=s.data}catch{S.add({severity:"error",summary:"Error",detail:"Failed to fetch recap data",life:3e3})}finally{v.value=!1}},F=()=>{d.value={prayer_type:null,start_date:null,end_date:null},c()},C=l=>{if(!l)return null;const s=new Date(l),b=s.getFullYear(),m=String(s.getMonth()+1).padStart(2,"0"),p=String(s.getDate()).padStart(2,"0");return`${b}-${m}-${p}`},V=l=>l>=80?"progress-excellent":l>=60?"progress-good":l>=40?"progress-average":"progress-poor",w=l=>{f.value=l,h.value=!0};return A(()=>{c()}),(l,s)=>{const b=u("Dropdown"),m=u("Calendar"),p=u("Button"),x=u("ProgressBar"),i=u("Column"),U=u("DataTable"),B=u("Card");return k(),y("div",H,[s[19]||(s[19]=a("div",{class:"page-header"},[a("h1",{class:"page-title"},"Rekap Pengguna")],-1)),t(B,null,{content:r(()=>[a("div",j,[a("div",J,[s[4]||(s[4]=a("label",null,"Jenis Sholat",-1)),t(b,{modelValue:d.value.prayer_type,"onUpdate:modelValue":s[0]||(s[0]=e=>d.value.prayer_type=e),options:T,optionLabel:"label",optionValue:"value",placeholder:"Semua",onChange:c},null,8,["modelValue"])]),a("div",O,[s[5]||(s[5]=a("label",null,"Tanggal Mulai",-1)),t(m,{modelValue:d.value.start_date,"onUpdate:modelValue":s[1]||(s[1]=e=>d.value.start_date=e),dateFormat:"yy-mm-dd",onDateSelect:c},null,8,["modelValue"])]),a("div",Y,[s[6]||(s[6]=a("label",null,"Tanggal Akhir",-1)),t(m,{modelValue:d.value.end_date,"onUpdate:modelValue":s[2]||(s[2]=e=>d.value.end_date=e),dateFormat:"yy-mm-dd",onDateSelect:c},null,8,["modelValue"])]),t(p,{label:"Hapus Filter",icon:"pi pi-filter-slash",onClick:F,severity:"secondary"})]),t(P($),{value:g.value,loading:v.value,class:"recap-dataview"},{list:r(e=>[(k(!0),y(z,null,I(e.items,o=>(k(),y("div",{class:"dataview-item",key:o.user_id},[a("div",q,[s[8]||(s[8]=a("div",{class:"user-avatar"},[a("i",{class:"pi pi-user"})],-1)),a("div",G,[a("h3",K,n(o.user_name),1),a("p",Q,[s[7]||(s[7]=a("i",{class:"pi pi-envelope"},null,-1)),M(" "+n(o.user_email),1)])])]),a("div",W,[a("div",X,[s[10]||(s[10]=a("div",{class:"stat-icon total"},[a("i",{class:"pi pi-chart-line"})],-1)),a("div",Z,[s[9]||(s[9]=a("span",{class:"stat-label"},"Total Catatan",-1)),a("span",aa,n(o.total_records),1)])]),a("div",sa,[s[12]||(s[12]=a("div",{class:"stat-icon success"},[a("i",{class:"pi pi-check-circle"})],-1)),a("div",ea,[s[11]||(s[11]=a("span",{class:"stat-label"},"Sholat",-1)),a("span",ta,n(o.sholat_count),1)])]),a("div",la,[s[14]||(s[14]=a("div",{class:"stat-icon danger"},[a("i",{class:"pi pi-times-circle"})],-1)),a("div",oa,[s[13]||(s[13]=a("span",{class:"stat-label"},"Tidak Sholat",-1)),a("span",na,n(o.tidak_sholat_count),1)])]),a("div",ra,[s[16]||(s[16]=a("div",{class:"stat-icon warning"},[a("i",{class:"pi pi-exclamation-circle"})],-1)),a("div",da,[s[15]||(s[15]=a("span",{class:"stat-label"},"Halangan",-1)),a("span",ia,n(o.halangan_count),1)])])]),a("div",ua,[a("div",ca,[s[17]||(s[17]=a("span",{class:"progress-title"},"Tingkat Penyelesaian",-1)),a("span",pa,n(o.percentage_sholat)+"%",1)]),t(x,{value:o.percentage_sholat,showValue:!1,style:{height:"0.875rem","border-radius":"0.5rem"},class:D(V(o.percentage_sholat))},null,8,["value","class"])]),t(p,{icon:"pi pi-calendar",label:"Lihat Detail",onClick:ka=>w(o),severity:"info",size:"small",class:"w-full",outlined:""},null,8,["onClick"])]))),128))]),empty:r(()=>[...s[18]||(s[18]=[a("div",{class:"empty-state"},[a("i",{class:"pi pi-chart-bar",style:{"font-size":"3rem",color:"#9ca3af"}}),a("p",null,"Tidak ada data tersedia. Silakan sesuaikan filter Anda.")],-1)])]),_:1},8,["value","loading"]),t(U,{value:g.value,loading:v.value,responsiveLayout:"scroll",class:"mt-4 desktop-only w-full",sortField:"percentage_sholat",sortOrder:-1},{default:r(()=>[t(i,{field:"user_name",header:"Nama",sortable:""}),t(i,{field:"user_email",header:"Email",sortable:""}),t(i,{field:"total_records",header:"Total Catatan",sortable:""},{body:r(e=>[a("span",_a,n(e.data.total_records),1)]),_:1}),t(i,{field:"sholat_count",header:"Sholat",sortable:""},{body:r(e=>[a("span",va,n(e.data.sholat_count),1)]),_:1}),t(i,{field:"tidak_sholat_count",header:"Tidak Sholat",sortable:""},{body:r(e=>[a("span",ma,n(e.data.tidak_sholat_count),1)]),_:1}),t(i,{field:"halangan_count",header:"Halangan",sortable:""},{body:r(e=>[a("span",ga,n(e.data.halangan_count),1)]),_:1}),t(i,{field:"percentage_sholat",header:"Persentase",sortable:""},{body:r(e=>[a("div",ha,[t(x,{value:e.data.percentage_sholat,showValue:!1,style:{height:"0.5rem",width:"100px"},class:D(V(e.data.percentage_sholat))},null,8,["value","class"]),a("span",fa,n(e.data.percentage_sholat)+"%",1)])]),_:1}),t(i,{header:"Aksi"},{body:r(e=>[t(p,{icon:"pi pi-calendar",label:"Lihat Detail",onClick:o=>w(e.data),severity:"info",size:"small"},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"])]),_:1}),t(R,{visible:h.value,"onUpdate:visible":s[3]||(s[3]=e=>h.value=e),userId:f.value?.user_id,userName:f.value?.user_name},null,8,["visible","userId","userName"])])}}},xa=E(ba,[["__scopeId","data-v-4d531724"]]);export{xa as default};
